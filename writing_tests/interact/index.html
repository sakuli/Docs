<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.56.3" />
    <meta name="description" content="">


    <link rel="icon" href="/docs/images/favicon.png" type="image/png">

    <title>Sakuli</title>

    
    <link href="/docs/css/nucleus.css" rel="stylesheet">
    <link href="/docs/css/fontawesome-all.min.css" rel="stylesheet">
    <link href="/docs/css/hybrid.css" rel="stylesheet">
    <link href="/docs/css/featherlight.min.css" rel="stylesheet">
    <link href="/docs/css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="/docs/css/auto-complete.css" rel="stylesheet">
    <link href="/docs/css/atom-one-dark-reasonable.css" rel="stylesheet">
    <link href="/docs/css/theme.css" rel="stylesheet">
    <link href="/docs/css/hugo-theme.css" rel="stylesheet">
    

    <script src="/docs/js/jquery-3.3.1.min.js"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/docs/writing_tests/interact/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">
  <img src="/docs/images/sakuli_01.svg" style="width: 250px; display: block; height: auto" />
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/docs/js/lunr.min.js"></script>
<script type="text/javascript" src="/docs/js/auto-complete.js"></script>
<script type="text/javascript">
    
        var baseurl = "\/docs";
    
</script>
<script type="text/javascript" src="/docs/js/search.js"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/docs/getting-started/" title="Getting Started" class="dd-item
        
        
        
        ">
      <a href="/docs/getting-started/">
          <i class='fas fa-chevron-right'></i>  Getting Started
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/prerequisites/" title="Prerequisites" class="dd-item ">
        <a href="/docs/getting-started/prerequisites/">
        Prerequisites
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/initialization/" title="Initialization" class="dd-item ">
        <a href="/docs/getting-started/initialization/">
        Initialization
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/installation/" title="Installation" class="dd-item ">
        <a href="/docs/getting-started/installation/">
        Installation
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/firsttest/" title="First Setup" class="dd-item ">
        <a href="/docs/getting-started/firsttest/">
        First Setup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/getting-started/version-control/" title="Version control systems" class="dd-item ">
        <a href="/docs/getting-started/version-control/">
        Version control systems
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/writing_tests/" title="Writing Tests" class="dd-item
        parent
        
        
        ">
      <a href="/docs/writing_tests/">
          <i class='fas fa-chevron-right'></i>  Writing Tests
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            


 
  
    
      <li data-nav-id="/docs/writing_tests/anatomy/" title="Anatomy" class="dd-item ">
        <a href="/docs/writing_tests/anatomy/">
        Anatomy
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/writing_tests/interact/" title="Interact" class="dd-item active">
        <a href="/docs/writing_tests/interact/">
        Interact
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/writing_tests/screenshot/" title="Screenshot" class="dd-item ">
        <a href="/docs/writing_tests/screenshot/">
        Screenshot
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/writing_tests/application/" title="Native applications" class="dd-item ">
        <a href="/docs/writing_tests/application/">
        Native applications
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/writing_tests/webtests/" title="Webtests" class="dd-item ">
        <a href="/docs/writing_tests/webtests/">
        Webtests
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/configuring_tests/" title="Configuring Tests" class="dd-item
        
        
        
        ">
      <a href="/docs/configuring_tests/">
          <i class='fas fa-chevron-right'></i>  Configuring Tests
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/enterprise_features/" title="Enterprise Features" class="dd-item
        
        
        
        ">
      <a href="/docs/enterprise_features/">
          <i class='fas fa-chevron-right'></i>  Enterprise Features
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            


 
  
    
      <li data-nav-id="/docs/enterprise_features/icinga/" title="Icinga2 Forwarder" class="dd-item ">
        <a href="/docs/enterprise_features/icinga/">
        Icinga2 Forwarder
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/enterprise_features/prometheus/" title="Prometheus Fowarder" class="dd-item ">
        <a href="/docs/enterprise_features/prometheus/">
        Prometheus Fowarder
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/enterprise_features/check/" title="checkmk Fowarder" class="dd-item ">
        <a href="/docs/enterprise_features/check/">
        checkmk Fowarder
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/enterprise_features/omd/" title="OMD Forwarder" class="dd-item ">
        <a href="/docs/enterprise_features/omd/">
        OMD Forwarder
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/enterprise_features/e2e/" title="Container" class="dd-item ">
        <a href="/docs/enterprise_features/e2e/">
        Container
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/enterprise_features/s2i/" title="S2I Image" class="dd-item ">
        <a href="/docs/enterprise_features/s2i/">
        S2I Image
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/cli/" title="CLI" class="dd-item
        
        
        
        ">
      <a href="/docs/cli/">
          <i class='fas fa-chevron-right'></i>  CLI
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/cookbook/" title="Cookbook" class="dd-item
        
        
        
        ">
      <a href="/docs/cookbook/">
          <i class='fas fa-chevron-right'></i>  Cookbook
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            


 
  
    
      <li data-nav-id="/docs/cookbook/handling-forms/" title="Handling forms" class="dd-item ">
        <a href="/docs/cookbook/handling-forms/">
        Handling forms
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/cookbook/waiting/" title="Waiting" class="dd-item ">
        <a href="/docs/cookbook/waiting/">
        Waiting
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/cookbook/invalid-session-id/" title="Error: Invalid session id" class="dd-item ">
        <a href="/docs/cookbook/invalid-session-id/">
        Error: Invalid session id
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/cookbook/container/" title="Run Container" class="dd-item ">
        <a href="/docs/cookbook/container/">
        Run Container
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/cookbook/proxy/" title="Container and Proxies" class="dd-item ">
        <a href="/docs/cookbook/proxy/">
        Container and Proxies
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/docs/cookbook/frames/" title="Frames" class="dd-item ">
        <a href="/docs/cookbook/frames/">
        Frames
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/docs/change_notes/" title="Change notes" class="dd-item
        
        
        
        ">
      <a href="/docs/change_notes/">
          <i class='fas fa-chevron-right'></i>  Change notes
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            


 
  
    
      <li data-nav-id="/docs/change_notes/2.3.0/" title="V2.3.0" class="dd-item ">
        <a href="/docs/change_notes/2.3.0/">
        V2.3.0
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      


      
      <div id="apiHead" class="padding">API Docs</div>
      <ul id="apiMenu">
        <li><a href="/apidoc/sakuli-legacy" target="_blank" >@sakuli/legacy</a></li>
      </ul>

      

      <hr/>

      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt" ></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/docs/'></a> > <a href='/docs/writing_tests/'>Writing Tests</a> > Interact
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
        <nav id="TableOfContents">
<ul>
<li><a href="#interacting-with-the-environment">Interacting with the environment</a>
<ul>
<li>
<ul>
<li><a href="#environment-variable">Environment variable</a></li>
<li><a href="#properties">Properties</a></li>
<li><a href="#getsimilarity-setsimilarity">getSimilarity/setSimilarity</a></li>
<li><a href="#screenshots">Screenshots</a></li>
<li><a href="#commands">Commands</a></li>
<li><a href="#os">OS</a></li>
</ul></li>
<li><a href="#keyboard-actions">Keyboard actions</a>
<ul>
<li><a href="#key-class">Key Class</a></li>
<li><a href="#type-paste-vs-keydown-keyup">type/paste vs keyDown/keyUp</a></li>
<li><a href="#clipboard">Clipboard</a></li>
<li><a href="#mouse-wheel">Mouse Wheel</a></li>
<li><a href="#sleep">sleep</a></li>
</ul></li>
<li><a href="#secrets">Secrets</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            
          

        





<h1 id="interacting-with-the-environment">Interacting with the environment</h1>

<p>In addition to screenshot-based test actions, Sakuli is capable of utilizing your keyboard, clipboard and environment variables.
All these features are incorporated with the
<a href="https://sakuli.io/apidoc/sakuli-legacy/interfaces/thenableenvironment.html" target="_blank">ThenableEnvironment</a>
interface.</p>

<h3 id="environment-variable">Environment variable</h3>

<p>To get a environment variable you can use <code>getEnv(key)</code> or <code>getEnvMasked(key)</code>. Only difference between these two is the
log output. <code>getEnv(key)</code> will also output <code>key</code> unlike <code>getEnvMasked(key)</code>.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">env</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Environment</span>();
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">path</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">getEnv</span>(<span style="color:#e6db74">&#34;PATH&#34;</span>);

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">homeDir</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">getEnvMasked</span>(<span style="color:#e6db74">&#34;HOME&#34;</span>);</code></pre></div>`</p>

<h3 id="properties">Properties</h3>

<p>You also might want to read some properties of your <code>sakuli.properties</code>/<code>testsuite.properties</code> file.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typerscript" data-lang="typerscript">const env = new Environment();

const id = await env.getProperty(&#34;testsuite.id&#34;);
const browser = await env.getPropertyMasked(&#34;testsuite.id&#34;) </code></pre></div></p>

<p>Only difference
between these <code>getProperty(key)</code> and <code>getPropertyMasked(key)</code> is the log output. <code>getEnv(key)</code> will also output <code>key</code> unlike <code>getEnvMasked(key)</code>.</p>

<h3 id="getsimilarity-setsimilarity">getSimilarity/setSimilarity</h3>

<p>For screenshot-based testing you can configure image-matching similarity in either <code>testsuite.properties</code> or
<code>sakuli.properties</code> file via <code>sakuli.environment.similarity.default</code>. <code>Environment.setSimilarity(number)</code> allows to
adjust this value during a testcase for additional flexibility.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">env</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Environment</span>();

<span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">setSimilarity</span>(<span style="color:#ae81ff">0.83</span>);   

<span style="color:#75715e">//resets to the similarity set in sakuli.environment.similarity.default
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">resetSimilarity</span>()

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">currentSimilarity</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">getSimilarity</span>();</code></pre></div>

<h3 id="screenshots">Screenshots</h3>

<p>You can also take Screenshot during a Sakuli test, which will be saved on testsuite level.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">env</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Environment</span>();

<span style="color:#75715e">//creates a screenshot with the filename &#34;screenshot_during_test.png&#34;
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">takeScreenshot</span>(<span style="color:#e6db74">&#34;screenshot_during_test.png&#34;</span>);

<span style="color:#75715e">//creates a screenshot with the filename &#34;2020-02-29T23-59-59_screenshot_during_test.png&#34;
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">takeScreenshotWithTimestamp</span>(<span style="color:#e6db74">&#34;screenshot_during_test.png&#34;</span>);</code></pre></div></p>

<h3 id="commands">Commands</h3>

<p>With the <code>ThenableEnvironment</code> you can also run terminal commands. If the second parameter is set to true, Sakuli throws
an exception if the command exits with a code other than 0.
<code>runCommand</code> returns a <a href="https://sakuli.io/apidoc/sakuli-legacy/classes/commandlineresult.html" target="_blank">Command Line Result</a>.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">env</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Environment</span>();
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileList</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">runCommand</span>(<span style="color:#e6db74">&#34;ls -al&#34;</span>)

<span style="color:#75715e">// both will never throw an exception even though sudo privileges are needed 
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">runCommand</span>(<span style="color:#e6db74">&#34;dpkg -i some_package.deb&#34;</span>);
<span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">runCommand</span>(<span style="color:#e6db74">&#34;dpkg -i some_package.deb&#34;</span>, <span style="color:#66d9ef">false</span>);

<span style="color:#75715e">//this will throw an exception
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">runCommand</span>(<span style="color:#e6db74">&#34;dpkg -i some_package.deb&#34;</span>, <span style="color:#66d9ef">true</span>);</code></pre></div>

<h3 id="os">OS</h3>

<p>You can use this to identify your operating system
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">env</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Environment</span>();
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">os</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">getOsIdentifier</span>();

<span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">isDarwin</span>();
<span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">isLinux</span>();
<span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">isWindows</span>();</code></pre></div></p>

<h2 id="keyboard-actions">Keyboard actions</h2>

<p>The following snippet shows a possible use-case for native keyboard actions.
When initiating a download in Firefox, a native file download dialog opens.
To start the download, we need to accept the file dialog, something that is not possible within the capabilities of Selenium.
With Sakuli you get the opportunity to work around this problem, just like a real user would do.
We can accept the file dialog by simply pressing the <code>Enter</code> button.
Use Firefox as a browser for this test to work, as Chrome simply downloads the file without user interaction:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript">(<span style="color:#a6e22e">async</span> () <span style="color:#f92672">=&gt;</span> {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">testCase</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">TestCase</span>(<span style="color:#e6db74">&#34;test&#34;</span>);
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://nodejs.org/en/&#34;</span>;
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">env</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Environment</span>();
    <span style="color:#66d9ef">try</span> {
        <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">_navigateTo</span>(<span style="color:#a6e22e">url</span>);
        <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">_click</span>(<span style="color:#a6e22e">_link</span>(<span style="color:#e6db74">&#34;ABOUT&#34;</span>));
        <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">_click</span>(<span style="color:#a6e22e">_link</span>(<span style="color:#e6db74">&#34;Releases&#34;</span>));
        <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">_click</span>(<span style="color:#a6e22e">_link</span>(<span style="color:#e6db74">&#34;Dubnium&#34;</span>));
        <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">_highlight</span>(<span style="color:#a6e22e">_link</span>(<span style="color:#e6db74">/node-v10.\d{1,}.\d{1,}.tar.gz/</span>));
        <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">_click</span>(<span style="color:#a6e22e">_link</span>(<span style="color:#e6db74">/node-v10.\d{1,}.\d{1,}.tar.gz/</span>));
        <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">_wait</span>(<span style="color:#ae81ff">3000</span>); <span style="color:#75715e">//wait for browser pop-up to activate
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">keyDown</span>(<span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">ENTER</span>);
        <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">keyUp</span>(<span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">ENTER</span>);
    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">e</span>) {
        <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">testCase</span>.<span style="color:#a6e22e">handleException</span>(<span style="color:#a6e22e">e</span>);
    } <span style="color:#66d9ef">finally</span> {
        <span style="color:#a6e22e">testCase</span>.<span style="color:#a6e22e">saveResult</span>();
    }
})();</code></pre></div>

<p>It is even possible to change the download location dynamically in some environments, by entering a new save path via:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;/new/path/to/file&#34;</span>);</code></pre></div>

<h3 id="key-class">Key Class</h3>

<p>Sometimes it is necessary to use control keys to navigate through a application. For such a case you can use the <code>Key</code> class.
A list of all Keys can be found in our <a href="https://sakuli.io/apidoc/sakuli-legacy/classes/key.html" target="_blank">Legacy API docs</a>.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">env</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Environment</span>();

<span style="color:#75715e">// open new tab in a browser
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">type</span>(<span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">T</span>, <span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">CTRL</span>);
<span style="color:#75715e">// alternatively
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;t&#34;</span>, <span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">CTRL</span>);

<span style="color:#75715e">// open a terminal in Ubuntu using two control keys
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">type</span>(<span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">T</span>, <span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">CTRL</span>, <span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">ALT</span>);</code></pre></div></p>

<h3 id="type-paste-vs-keydown-keyup">type/paste vs keyDown/keyUp</h3>

<p>As you might have noticed, there are multiple ways to simulate keyboard input with Sakuli. On the one hand we have
<code>type(text: string, ...optModifiers: Key[])</code> and <code>paste(text: string)</code> and on the other hand there is <code>keyDown(...keys: Key[])</code>
with <code>keyUp(...keys: Key[])</code>.
If you just want to input text into a textbox, you might want to use <code>paste</code> because it just
pastes the text whereas <code>type</code> &ldquo;simulates&rdquo; the enduser and types every letter individually. With <code>type</code> it is also possible
to use modifier keys such as CTRL, CMD or ALT. So if you want to use a shortcut like opening a new Tab in a browser with
CTRL+T, you can handle it with <code>env.type(Key.T, Key.CTRL)</code>.
<code>keyDown</code>/<code>keyUp</code> is useful when you need a key pressed such as ctrl-click a link. This will open the link in a new tab.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">env</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Environment</span>();

<span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">paste</span>(<span style="color:#e6db74">&#34;Just paste this text somewhere&#34;</span>);

<span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;pls write this all in capital letters&#34;</span>, <span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">SHIFT</span>);

<span style="color:#75715e">//open print dialog
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">type</span>(<span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">P</span>, <span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">CTRL</span>);


<span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">keyDown</span>(<span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">CTRL</span>);
<span style="color:#75715e">//click links to open in a new Tab or do something else
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">keyUp</span>(<span style="color:#a6e22e">Key</span>.<span style="color:#a6e22e">CTRL</span>);</code></pre></div></p>

<h3 id="clipboard">Clipboard</h3>

<p>You can also utilize the clipboard to paste a text.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">env</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Environment</span>();

<span style="color:#75715e">//just presses CTRL+C
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">copyIntoClipboard</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">clipboard</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">getClipboard</span>();

<span style="color:#75715e">//just presses CTRL+V
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">pasteClipboard</span>()

<span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">setClipboard</span>(<span style="color:#e6db74">&#34;set this string into the clipboard&#34;</span>);</code></pre></div></p>

<h3 id="mouse-wheel">Mouse Wheel</h3>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">env</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Environment</span>();
<span style="color:#75715e">//scrolls down on a webpage 
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">mouseWheelDown</span>(<span style="color:#ae81ff">10</span>)

<span style="color:#75715e">//scrolls up
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">mouseWheelUp</span>(<span style="color:#ae81ff">5</span>);</code></pre></div>

<h3 id="sleep">sleep</h3>

<p>Similar to <code>_wait</code> in a Sakuli webtest, you can use <code>sleep(number)</code> or <code>sleepMs(number)</code> to wait on e.g. excel to start.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">env</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Environment</span>();

<span style="color:#75715e">//waits 5 seconds
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">sleep</span>(<span style="color:#ae81ff">5</span>);

<span style="color:#75715e">//waits 1 second
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">sleepMs</span>(<span style="color:#ae81ff">1000</span>);</code></pre></div></p>

<h2 id="secrets">Secrets</h2>

<p>Many E2E tests require some kind of login.
While there is no problem in general, it still requires some mechanism to handle credentials.
Providing credentials via environment variable is a common practice, but it still is inconvenient when deploying the testcase to another system, since every single environment variable has to be migrated too.</p>

<p>Sakuli comes with a built-in mechanism to deal with sensitive data in testcases.
It uses a single masterkey, generated by Sakuli itself, to de- or encrypt secrets used in testcases.</p>

<p>Running</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#a6e22e">npx</span> <span style="color:#a6e22e">sakuli</span> <span style="color:#a6e22e">create</span> <span style="color:#a6e22e">masterkey</span></code></pre></div>

<p>will generate a new masterkey, which should be exported as an environment variable <code>SAKULI_ENCRYPTION_KEY</code>.</p>

<p>Once the masterkey has been exported, secrets can be encrypted by running:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#a6e22e">npx</span> <span style="color:#a6e22e">sakuli</span> <span style="color:#a6e22e">encrypt</span> <span style="color:#e6db74">&#34;super secret string&#34;</span></code></pre></div>

<p>These encrypted secrets can now be stored safely inside your testfile. The <code>ThenableEnvironment</code> interface provides methods to decrypt these secrets during test execution.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">typeAndDecrypt</span>(<span style="color:#e6db74">&#34;$ENCRYPTED_SECRET&#34;</span>);
<span style="color:#75715e">// alternatively, via clipboard
</span><span style="color:#75715e"></span><span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">pasteAndDecrypt</span>(<span style="color:#e6db74">&#34;$ENCRYPTED_SECRET&#34;</span>);

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">secret</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">decryptSecret</span>(<span style="color:#e6db74">&#34;$ENCRYPTED_SECRET&#34;</span>);</code></pre></div>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/docs/writing_tests/anatomy/" title="Anatomy"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/docs/writing_tests/screenshot/" title="Screenshot" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/docs/js/clipboard.min.js"></script>
    <script src="/docs/js/perfect-scrollbar.min.js"></script>
    <script src="/docs/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="/docs/js/jquery.sticky.js"></script>
    <script src="/docs/js/featherlight.min.js"></script>
    <script src="/docs/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/docs/js/modernizr.custom-3.6.0.js"></script>
    <script src="/docs/js/learn.js"></script>
    <script src="/docs/js/hugo-learn.js"></script>

    <link href="/docs/mermaid/mermaid.css" rel="stylesheet" />
    <script src="/docs/mermaid/mermaid.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

